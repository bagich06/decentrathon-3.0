# RTMP → RTSP/HLS Конвертер

## Описание

Этот проект — сервис-конвертер, который позволяет принимать видеопотоки в формате RTMP (например, от дронов, камер, стриминговых платформ) и отдавать их в формате RTSP и HLS. Это решает проблему интеграции между системами, которые поддерживают только RTSP/HLS, и источниками, которые выдают только RTMP.

- **Язык:** Go
- **Конвертация:** FFmpeg
- **RTSP/HLS-сервер:** MediaMTX (ex rtsp-simple-server)
- **REST API и веб-интерфейс:** Gin + React (Vite)
- **Встроенный HLS-плеер:** hls.js (просмотр трансляции прямо на сайте)
- **Визуализация движения дрона:** Leaflet.js, WebSocket, история маршрутов
- **Контейнеризация:** Docker, docker-compose
- **Современный военный UI:** минимализм, тёмная тема, хаки-оливковые акценты

---

## Возможности

- Приём RTMP-потоков и выдача их как RTSP и HLS
- Одновременная работа с несколькими потоками
- Веб-интерфейс для управления потоками (запуск, остановка, статус)
- Онлайн-просмотр трансляции (HLS) прямо на сайте
- Визуализация движения дрона на карте, эмуляция полёта, история маршрутов
- Логирование событий
- Лёгкий запуск и тестирование через Docker Compose

---

## Быстрый старт

### 1. Клонируйте репозиторий и перейдите в папку проекта

```sh
cd <папка_проекта>
```

### 2. Запустите все сервисы

```sh
docker-compose up --build
```

- Backend (Go + FFmpeg) будет доступен на `localhost:8080`
- RTSP/HLS-сервер (MediaMTX) — на `localhost:8554` (RTSP), `localhost:8888` (HLS)
- Веб-интерфейс — на `localhost:3000`

---

## Как пользоваться

### 1. Сгенерируйте тестовый RTMP-поток (пример с ffmpeg)

В новом терминале выполните:

```sh
ffmpeg -re -f lavfi -i testsrc=size=1280x720:rate=30 -f lavfi -i sine=frequency=1000 -c:v libx264 -c:a aac -f flv rtmp://localhost:1935/test
```

### 2. Добавьте поток через веб-интерфейс

- Откройте [http://localhost:3000](http://localhost:3000)
- В поле **RTMP URL** вставьте: `rtmp://localhost:1935/test`
- В поле **Stream Key** вставьте: `test`
- Нажмите **СТАРТ**

### 3. Воспроизведите поток прямо на сайте

- В разделе **Онлайн-трансляция (HLS)** выберите нужный поток — видео появится прямо на странице.
- HLS-поток также доступен по ссылке: `http://localhost:8888/test/index.m3u8`

### 4. Управляйте потоками

- Останавливайте и запускайте потоки через веб-интерфейс.
- Копируйте RTSP-ссылку для сторонних плееров (VLC, ffplay).

### 5. Визуализация движения дрона

- Перейдите на страницу **Карты отслеживания БПЛА**.
- Эмулируйте полёт, отправляйте точки, стройте и сохраняйте маршруты.
- Просматривайте историю маршрутов и телеметрию в реальном времени.

---

## Для чего это нужно?

- Интеграция дронов, камер, стриминговых платформ с системами видеонаблюдения
- Унификация видеопотоков для разных систем
- Быстрая демонстрация, тестирование и визуализация потоков
- Отображение и анализ маршрутов движения БПЛА

---

## Требования

- Docker и docker-compose
- ffmpeg (для генерации тестового потока)
- VLC или ffplay (для просмотра RTSP, опционально)

---

## Структура проекта

- `main.go` — backend (Go, REST API, запуск ffmpeg, логика потоков, маршруты)
- `frontend/` — веб-интерфейс (React, HLS-плеер, карта, UI)
- `docker-compose.yml` — запуск всех сервисов
- `Dockerfile` — сборка backend
- `frontend/Dockerfile` — сборка фронта
- `routes.json` — история маршрутов (создаётся автоматически)

---

## Авторы и поддержка

- Проект создан для хакатона.
- Вопросы и предложения — через Issues или напрямую разработчику.
